/*! jWizard v1.7.0 ... Built: 2013-02-13 */
(function(a){a.widget("db.jWizard",{_stepIndex:0,_stepCount:0,_actualCount:0,_create:function(){this._buildSteps(),this._buildTitle(),this.options.menuEnable&&this._buildMenu(),this._buildButtons(),this.options.counter.enable&&this._buildCounter(),this.element.addClass("ui-widget jw-widget"),this._hoverable(this.element.find(".ui-state-default")),this._changeStep(this._stepIndex,!0)},destroy:function(){this._destroySteps(),this._destroyTitle(),this.options.menuEnable&&this._destroyMenu(),this._destroyButtons(),this.options.counter.enable&&this._destroyCounter(),this.element.removeClass("ui-widget jw-widget"),this._super()},disable:function(){this.element.addClass("ui-state-disabled").find("button").attr("disabled","disabled")},enable:function(){this.element.removeClass("ui-state-disabled").find("button").removeAttr("disabled")},option:function(a,b){if(this._superApply(arguments),"string"==typeof a&&b!==void 0){var c=a.split(".");switch(c[0]){case"buttons":switch(c[1]){case"jqueryui":if("enable"===c[2]){b?this.find(".jw-buttons > button").button("destroy"):(this._destroyButtons(),this._buildButtons());break}break;case"cancelHide":this.element.find(".jw-button-cancel").toggleClass("ui-helper-hidden",!!b);break;case"cancelType":this.element.find(".jw-button-cancel").attr("type",b);break;case"finishType":this.element.find(".jw-button-finish").attr("type",b);break;case"cancelText":this.element.find(".jw-button-cancel").text(b);break;case"previousText":this.element.find(".jw-button-previous").text(b);break;case"nextText":this.element.find(".jw-button-next").text(b);break;case"finishText":this.element.find(".jw-button-finish").text(b)}break;case"counter":switch(c[1]){case"enable":value?(this._buildCounter(),this._updateCounter()):this._destroyCounter();break;case"type":case"progressbar":case"location":this.options.counter.enable&&(this._destroyCounter(),this._buildCounter(),this._updateCounter());break;case"startCount":case"startHide":case"finishCount":case"finishHide":case"appendText":case"orientText":this.options.counter.enable&&this._updateCounter()}}}},_setOption:function(a,b){switch(this._superApply(arguments),a){case"titleHide":this.element.find(".jw-header").toggleClass("ui-helper-hidden",!!b);break;case"menuEnable":b?(this._buildMenu(),this._updateMenu()):this._destroyMenu();break;case"counter":this._destroyCounter(),this._buildCounter(),this._updateCounter()}},firstStep:function(){this.changeStep(0,"first")},lastStep:function(){this.changeStep(this._stepCount-1,"last")},nextStep:function(){var a={wizard:this.element,currentStepIndex:this._stepIndex,nextStepIndex:this._stepIndex+1,delta:1};this._trigger("next",null,a)!==!1&&this.changeStep(this._stepIndex+1,"next")},previousStep:function(){var a={wizard:this.element,currentStepIndex:this._stepIndex,nextStepIndex:this._stepIndex-1,delta:-1};this._trigger("previous",null,a)!==!1&&this.changeStep(this._stepIndex-1,"previous")},changeStep:function(b,c){c=c||"manual",b="number"==typeof b?b:a(b).index();var d={wizard:this.element,currentStepIndex:this._stepIndex,nextStepIndex:b,delta:b-this._stepIndex,type:c};this._trigger("changestep",null,d)!==!1&&this._changeStep(b)},_effect:function(b,c,d,e,f){var h=this.options.effects[c][d];return e=e||"effect",b.length&&b.hasClass("jw-animated")?(h.callback=f||a.noop,b[e](h.type,h.options,h.duration,h.callback),void 0):(b[e](),f&&f.call(this),!1)},_updateNavigation:function(a){this._updateButtons(),this.options.menuEnable&&this._updateMenu(a),this.options.counter.enable&&this._updateCounter(a)},_buildTitle:function(){this.element.prepend(a("<div />",{"class":"jw-header ui-widget-header ui-corner-top"+(this.options.titleHide?" ui-helper-hidden":""),html:'<h2 class="jw-title'+(this.options.effects.enable||this.options.effects.title.enable?" jw-animated":"")+'" />'}))},_updateTitle:function(a){var b=this,c=this.element.find(".jw-title"),d=this.element.find(".jw-step:eq("+this._stepIndex+")");a?c.text(d.attr("title")):this._effect(c,"title","hide","hide",function(){c.text(d.attr("title")||d.data("title")),b._effect(c,"title","show","show")})},_destroyTitle:function(){this.element.children(".jw-header").remove()},_buildSteps:function(){var b=this.element.children("div, fieldset");this._stepCount=b.length,b.addClass("jw-step").each(function(){var c=a(this);"fieldset"===this.tagName.toLowerCase()&&c.attr("title",c.find("legend").text())}),(this.options.effects.enable||this.options.effects.step.enable)&&b.addClass("jw-animated"),b.hide().wrapAll(a("<div />",{"class":"jw-content ui-widget-content ui-helper-clearfix",html:'<div class="jw-steps-wrap" />'})).eq(this._stepIndex).show()},_destroySteps:function(){this.element.find(".jw-step").show().unwrap().unwrap().unbind("show hide").removeClass("jw-step")},_changeStep:function(a,b){var c=this,d=this.element.find(".jw-step"),e=d.eq(this._stepIndex);if("number"==typeof a){if(0>a||a>d.length-1)return alert("Index "+a+" Out of Range"),!1;a=d.eq(a)}else if("object"==typeof a&&!a.is(d.selector))return alert("Supplied Element is NOT one of the Wizard Steps"),!1;b?(this._stepIndex=d.index(a),this._updateTitle(b),this._updateNavigation(b)):(this._disableButtons(),this._stepIndex=d.index(a),this._updateTitle(b),this._effect(e,"step","hide","hide",function(){c._effect(a,"step","show","show",function(){c._enableButtons(),c._updateNavigation(b)})}))},_buildMenu:function(){var c,b=[];this.element.addClass("jw-hasmenu"),this.element.find(".jw-step").each(function(c){b.push(a("<li />",{"class":"ui-corner-all "+(0===c?"jw-current ui-state-highlight":"jw-inactive ui-state-disabled"),html:a("<a />",{step:c,text:a(this).attr("title")})})[0])}),c=a("<div />",{"class":"jw-menu-wrap",html:a("<div />",{"class":"jw-menu",html:a("<ol />",{html:a(b)})})}),this.element.find(".jw-content").prepend(c),(this.options.effects.enable||this.options.effects.menu.enable)&&c.find("li").addClass("jw-animated"),c.find("a").click(a.proxy(function(b){var c=a(b.target),d=parseInt(c.attr("step"),10);c.parent().hasClass("jw-active")&&this.changeStep(d,this._stepIndex>=d?"previous":"next")},this))},_destroyMenu:function(){this.element.removeClass("jw-hasmenu").find(".jw-menu-wrap").remove()},_updateMenu:function(b){var d=this._stepIndex,e=this.element.find(".jw-menu");b||this._effect(e.find("li:eq("+d+")"),"menu","change"),e.find("a").each(function(){var c=a(this),e=c.parent(),f=parseInt(c.attr("step"),10),g="";d>f?g+="jw-active ui-state-default":f===d?g+="jw-current ui-state-highlight":f>d&&(g+="jw-inactive ui-state-disabled",c.removeAttr("href")),e.removeClass("jw-active jw-current jw-inactive ui-state-default ui-state-highlight ui-state-disabled").addClass(g)})},_buildCounter:function(){var b=a("<span />",{"class":"jw-counter ui-widget-content ui-corner-all jw-"+this.options.counter.orientText});"header"===this.options.counter.location?this.element.find(".jw-header").prepend(b):"footer"===this.options.counter.location&&this.element.find(".jw-footer").prepend(b),this.options.counter.startCount||this._stepCount--,this.options.counter.finishCount||this._stepCount--,(this.options.effects.enable||this.options.effects.counter.enable)&&b.addClass("jw-animated"),this.options.counter.progressbar&&b.html('<span class="jw-counter-text" /> <span class="jw-counter-progressbar" />').find(".jw-counter-progressbar").progressbar()},_updateCounter:function(a){var b=this.element.find(".jw-counter"),c=this.options.counter,d="",e=this._stepIndex,f=this._stepCount,g=0;c.startCount||(e--,f--),a||this._effect(b,"counter","change"),g=Math.round(100*(e/f)),"percentage"===c.type?d=(100>=g?g:100)+"%":"count"===c.type?(d=0>e?0:e>f?f:e,d+=" of "+f):d="N/A",c.appendText&&(d+=" "+c.appendText),c.progressbar?(this.element.find(".jw-counter-progressbar").progressbar("option","value",g),this.element.find(".jw-counter-text").text(d)):b.text(d),c.startHide&&0===this._stepIndex||c.finishHide&&this._stepIndex===this._actualCount-1?b.hide():b.show()},_destroyCounter:function(){this.element.find(".jw-counter").remove()},_buildButtons:function(){var b=this,c=this.options.buttons,d=a("<div />",{"class":"jw-footer ui-widget-header ui-corner-bottom"}),e=a('<button type="'+c.cancelType+'" class="ui-state-default ui-corner-all jw-button-cancel ui-priority-secondary'+(c.cancelHide?" ui-helper-hidden":"")+'">'+c.cancelText+"</button>"),f=a('<button type="button" class="ui-state-default ui-corner-all jw-button-previous">'+c.previousText+"</button>"),g=a('<button type="button" class="ui-state-default ui-corner-all jw-button-next">'+c.nextText+"</button>"),h=a('<button type="'+c.finishType+'" class="ui-state-default ui-corner-all jw-button-finish ui-state-highlight">'+c.finishText+"</button>");e.click(function(a){b._trigger("cancel",a)}),f.click(function(){b.previousStep()}),g.click(function(){b.nextStep()}),h.click(function(a){b._trigger("finish",a)}),c.jqueryui.enable&&(e.button({icons:{primary:c.jqueryui.cancelIcon}}),f.button({icons:{primary:c.jqueryui.previousIcon}}),g.button({icons:{secondary:c.jqueryui.nextIcon}}),h.button({icons:{secondary:c.jqueryui.finishIcon}})),this.element.append(d.append(a('<div class="jw-buttons" />').append(e).append(f).append(g).append(h)))},_updateButtons:function(){var a=this.element.find(".jw-step"),b=this.element.find(".jw-button-previous"),c=this.element.find(".jw-button-next"),d=this.element.find(".jw-button-finish");switch(a.index(a.filter(":visible"))){case-1:case 0:b.hide(),c.show(),d.hide();break;case a.length-1:b.show(),c.hide(),d.show();break;default:b.show(),c.show(),d.hide()}},_disableButtons:function(){this.element.find(".jw-buttons button").addClass("ui-state-disabled").attr("disabled",!0)},_enableButtons:function(){this.element.find(".jw-buttons button").removeClass("ui-state-disabled").attr("disabled",!1)},_destroyButtons:function(){this.element.find(".jw-footer").remove()},options:{titleHide:!1,menuEnable:!1,buttons:{jqueryui:{enable:!1,cancelIcon:"ui-icon-circle-close",previousIcon:"ui-icon-circle-triangle-w",nextIcon:"ui-icon-circle-triangle-e",finishIcon:"ui-icon-circle-check"},cancelHide:!1,cancelType:"button",finishType:"button",cancelText:"Cancel",previousText:"Previous",nextText:"Next",finishText:"Finish"},counter:{enable:!1,type:"count",progressbar:!1,location:"footer",startCount:!0,startHide:!1,finishCount:!0,finishHide:!1,appendText:"Complete",orientText:"left"},effects:{enable:!1,step:{enable:!1,hide:{type:"slide",options:{direction:"left"},duration:"fast"},show:{type:"slide",options:{direction:"left"},duration:"fast"}},title:{enable:!1,hide:{type:"slide",duration:"fast"},show:{type:"slide",duration:"fast"}},menu:{enable:!1,change:{type:"highlight",duration:"fast"}},counter:{enable:!1,change:{type:"highlight",duration:"fast"}}},cancel:a.noop,previous:a.noop,next:a.noop,finish:a.noop,changestep:function(a,b){return a.isDefaultPrevented()&&a.nextStepIndex!==void 0?(b.wizard.jWizard("changeStep",a.nextStepIndex),!1):void 0}}})})(jQuery);
